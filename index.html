<html lang="zh-CN"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>临时链接生成器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#00f0ff',
                        secondary: '#6d28d9',
                        dark: '#0f172a',
                        darker: '#020617',
                        light: '#e2e8f0',
                    },
                    fontFamily: {
                        tech: ['Orbitron', 'sans-serif', 'system-ui'],
                    },
                    animation: {
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 5px rgba(0, 240, 255, 0.5), 0 0 10px rgba(0, 240, 255, 0.3)' },
                            '100%': { boxShadow: '0 0 10px rgba(0, 240, 255, 0.8), 0 0 20px rgba(0, 240, 255, 0.5), 0 0 30px rgba(0, 240, 255, 0.3)' },
                        }
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .text-shadow-glow {
                text-shadow: 0 0 10px rgba(0, 240, 255, 0.7), 0 0 20px rgba(0, 240, 255, 0.5);
            }
            .border-glow {
                box-shadow: 0 0 5px rgba(0, 240, 255, 0.7), 0 0 10px rgba(0, 240, 255, 0.5);
            }
            .bg-grid {
                background-size: 40px 40px;
                background-image: 
                    linear-gradient(to right, rgba(0, 240, 255, 0.05) 1px, transparent 1px),
                    linear-gradient(to bottom, rgba(0, 240, 255, 0.05) 1px, transparent 1px);
            }
            .glass {
                background: rgba(15, 23, 42, 0.7);
                backdrop-filter: blur(10px);
                -webkit-backdrop-filter: blur(10px);
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;600;700&amp;display=swap" rel="stylesheet">
</head>
<body class="bg-darker bg-grid min-h-screen text-light font-tech overflow-x-hidden">
    <!-- 背景装饰 -->
    <div class="fixed inset-0 z-0 overflow-hidden pointer-events-none">
        <div class="absolute top-1/4 left-1/4 w-64 h-64 bg-primary/10 rounded-full filter blur-3xl animate-pulse-slow"></div>
        <div class="absolute bottom-1/3 right-1/3 w-96 h-96 bg-secondary/10 rounded-full filter blur-3xl animate-pulse-slow" style="animation-delay: 1s;"></div>
    </div>

    <!-- 密码验证界面 -->
    <div id="password-screen" class="min-h-screen flex items-center justify-center p-4 z-10 relative">
        <div class="glass rounded-xl p-8 w-full max-w-md border border-primary/30 animate-float">
            <h1 class="text-3xl font-bold text-center mb-6 text-primary text-shadow-glow">身份验证</h1>
            <p class="text-center mb-6 text-light/70">请输入访问密码</p>
            
            <div class="mb-4">
                <label for="password" class="block mb-2 text-primary/80">密码</label>
                <div class="relative">
                    <input type="password" id="password" class="w-full bg-dark/50 border border-primary/50 rounded-lg px-4 py-3 text-light focus:outline-none focus:border-primary transition-all duration-300" placeholder="输入密码">
                    <button id="toggle-password" class="absolute right-3 top-1/2 transform -translate-y-1/2 text-primary/70 hover:text-primary transition-colors">
                        <i class="fa fa-eye-slash"></i>
                    </button>
                </div>
            </div>
            
            <button id="login-btn" class="w-full bg-primary/20 hover:bg-primary/30 text-primary border border-primary/50 rounded-lg py-3 transition-all duration-300 font-medium flex items-center justify-center gap-2 animate-glow">
                <span>验证访问</span>
                <i class="fa fa-arrow-right"></i>
            </button>
            
            <p id="error-message" class="text-red-400 text-center mt-4 hidden">密码错误，请重试</p>
        </div>
    </div>

    <!-- 主工具界面 -->
    <div id="tool-screen" class="hidden p-4 md:p-8 z-10 relative">
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-primary text-shadow-glow mb-2">临时链接生成</h1>
            <p class="text-light/70 max-w-2xl">创建包含自定义内容的临时链接，可设置有效期和最大访问次数</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- 左侧：设置面板 -->
            <div class="lg:col-span-1">
                <div class="glass rounded-xl p-6 border border-primary/30 h-full">
                    <h2 class="text-2xl font-semibold text-primary mb-6">链接设置</h2>
                    
                    <div class="space-y-6">
                        <!-- 内容类型选择 -->
                        <div>
                            <label class="block mb-2 text-primary/80">内容类型</label>
                            <div class="grid grid-cols-3 gap-2">
                                <button class="content-type-btn active py-2 px-3 rounded-lg border border-primary bg-primary/10 text-primary transition-all" data-type="text">
                                    <i class="fa fa-file-text-o block text-center mb-1"></i>
                                    <span class="text-sm">文字</span>
                                </button>
                                <button class="content-type-btn py-2 px-3 rounded-lg border border-primary/30 hover:border-primary hover:bg-primary/5 text-light/70 hover:text-primary transition-all" data-type="url">
                                    <i class="fa fa-link block text-center mb-1"></i>
                                    <span class="text-sm">网址</span>
                                </button>
                                <button class="content-type-btn py-2 px-3 rounded-lg border border-primary/30 hover:border-primary hover:bg-primary/5 text-light/70 hover:text-primary transition-all" data-type="image">
                                    <i class="fa fa-image block text-center mb-1"></i>
                                    <span class="text-sm">图片</span>
                                </button>
                            </div>
                        </div>
                        
                        <!-- 内容输入区域 -->
                        <div id="text-content" class="content-input">
                            <label for="content-text" class="block mb-2 text-primary/80">文字内容</label>
                            <textarea id="content-text" rows="5" class="w-full bg-dark/50 border border-primary/50 rounded-lg px-4 py-3 text-light focus:outline-none focus:border-primary transition-all resize-none" placeholder="输入要包含的文字内容..."></textarea>
                        </div>
                        
                        <div id="url-content" class="content-input hidden">
                            <label for="content-url" class="block mb-2 text-primary/80">网址</label>
                            <input type="url" id="content-url" class="w-full bg-dark/50 border border-primary/50 rounded-lg px-4 py-3 text-light focus:outline-none focus:border-primary transition-all" placeholder="https://example.com">
                        </div>
                        
                        <div id="image-content" class="content-input hidden">
                            <label class="block mb-2 text-primary/80">图片</label>
                            <div id="image-dropzone" class="w-full bg-dark/50 border-2 border-dashed border-primary/50 rounded-lg p-6 text-center hover:border-primary transition-all cursor-pointer">
                                <i class="fa fa-cloud-upload text-3xl text-primary/70 mb-2"></i>
                                <p class="text-light/70">拖放图片到此处，或<span class="text-primary">点击上传</span></p>
                                <input type="file" id="image-upload" accept="image/*" class="hidden">
                            </div>
                            <div id="image-preview" class="mt-4 hidden">
                                <img id="preview-img" src="" alt="预览图片" class="max-w-full max-h-40 mx-auto rounded">
                                <button id="remove-image" class="mt-2 text-sm text-red-400 hover:text-red-300 transition-colors">
                                    <i class="fa fa-times"></i> 移除图片
                                </button>
                            </div>
                        </div>
                        
                        <!-- 有效期设置 -->
                        <div>
                            <label for="expiry-time" class="block mb-2 text-primary/80">有效期 (分钟)</label>
                            <input type="number" id="expiry-time" min="1" value="5" class="w-full bg-dark/50 border border-primary/50 rounded-lg px-4 py-3 text-light focus:outline-none focus:border-primary transition-all">
                        </div>
                        
                        <!-- 最大访问次数 -->
                        <div>
                            <label for="max-views" class="block mb-2 text-primary/80">最大访问次数</label>
                            <input type="number" id="max-views" min="1" value="3" class="w-full bg-dark/50 border border-primary/50 rounded-lg px-4 py-3 text-light focus:outline-none focus:border-primary transition-all">
                        </div>
                        
                        <button id="generate-btn" class="w-full bg-primary/20 hover:bg-primary/30 text-primary border border-primary/50 rounded-lg py-3 transition-all duration-300 font-medium flex items-center justify-center gap-2">
                            <span>生成链接</span>
                            <i class="fa fa-magic"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- 右侧：生成结果和历史记录 -->
            <div class="lg:col-span-2">
                <!-- 生成结果 -->
                <div id="result-container" class="glass rounded-xl p-6 border border-primary/30 mb-8 hidden">
                    <h2 class="text-2xl font-semibold text-primary mb-4">生成结果</h2>
                    
                    <div class="mb-4 p-4 bg-dark/30 rounded-lg border border-primary/20">
                        <div class="flex items-center break-all">
                            <i class="fa fa-link text-primary mr-2"></i>
                            <span id="generated-link" class="text-light"></span>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-2 md:grid-cols-3 gap-4 text-sm">
                        <div class="p-3 bg-dark/20 rounded-lg border border-primary/10">
                            <p class="text-light/60 mb-1">有效期</p>
                            <p id="result-expiry" class="text-primary font-medium"></p>
                        </div>
                        <div class="p-3 bg-dark/20 rounded-lg border border-primary/10">
                            <p class="text-light/60 mb-1">最大访问次数</p>
                            <p id="result-views" class="text-primary font-medium"></p>
                        </div>
                        <div class="p-3 bg-dark/20 rounded-lg border border-primary/10 col-span-2 md:col-span-1">
                            <p class="text-light/60 mb-1">创建时间</p>
                            <p id="result-created" class="text-primary font-medium"></p>
                        </div>
                    </div>
                    
                    <div class="mt-6 flex flex-wrap gap-3">
                        <button id="copy-link" class="px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary border border-primary/50 rounded-lg transition-all duration-300 flex items-center gap-2">
                            <i class="fa fa-copy"></i>
                            <span>复制链接</span>
                        </button>
                        <button id="open-link" class="px-4 py-2 bg-primary/20 hover:bg-primary/30 text-primary border border-primary/50 rounded-lg transition-all duration-300 flex items-center gap-2">
                            <i class="fa fa-external-link"></i>
                            <span>打开链接</span>
                        </button>
                        <button id="new-link" class="px-4 py-2 bg-secondary/20 hover:bg-secondary/30 text-secondary border border-secondary/50 rounded-lg transition-all duration-300 flex items-center gap-2 ml-auto">
                            <i class="fa fa-plus"></i>
                            <span>新链接</span>
                        </button>
                    </div>
                </div>
                
                <!-- 历史记录 -->
                <div class="glass rounded-xl p-6 border border-primary/30">
                    <h2 class="text-2xl font-semibold text-primary mb-4 flex items-center gap-2">
                        <span>历史记录</span>
                        <span id="history-count" class="text-sm bg-primary/20 text-primary px-2 py-1 rounded-full">0</span>
                    </h2>
                    
                    <div id="history-list" class="space-y-4 max-h-96 overflow-y-auto pr-2">
                        <div class="text-center text-light/50 py-8">
                            <i class="fa fa-history text-4xl mb-3"></i>
                            <p>暂无历史记录</p>
                        </div>
                    </div>
                    
                    <button id="clear-history" class="mt-6 text-sm text-light/60 hover:text-red-400 transition-colors flex items-center gap-1">
                        <i class="fa fa-trash-o"></i>
                        <span>清空历史记录</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- 链接查看页面 (默认隐藏，通过URL参数访问) -->
    <div id="view-screen" class="hidden min-h-screen flex items-center justify-center p-4 z-10 relative">
        <div class="glass rounded-xl p-8 w-full max-w-2xl border border-primary/30">
            <div id="valid-content">
                <!-- 内容将通过JS动态填充 -->
            </div>
            
            <div id="expired-content" class="text-center hidden">
                <div class="w-20 h-20 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-6">
                    <i class="fa fa-lock text-4xl text-red-400"></i>
                </div>
                <h2 class="text-2xl font-bold text-red-400 mb-3">链接已失效</h2>
                <p class="text-light/70">感谢您的建议，该链接已过期或达到最大访问次数</p>
            </div>
        </div>
    </div>

    <script>
        // 存储生成的链接数据
        let linksData = JSON.parse(localStorage.getItem('tempLinks')) || {};
        let currentLinkId = null;
        
        // DOM 元素
        const passwordScreen = document.getElementById('password-screen');
        const toolScreen = document.getElementById('tool-screen');
        const viewScreen = document.getElementById('view-screen');
        const validContent = document.getElementById('valid-content');
        const expiredContent = document.getElementById('expired-content');
        const loginBtn = document.getElementById('login-btn');
        const passwordInput = document.getElementById('password');
        const togglePassword = document.getElementById('toggle-password');
        const errorMessage = document.getElementById('error-message');
        const contentTypes = document.querySelectorAll('.content-type-btn');
        const contentInputs = document.querySelectorAll('.content-input');
        const generateBtn = document.getElementById('generate-btn');
        const resultContainer = document.getElementById('result-container');
        const generatedLinkEl = document.getElementById('generated-link');
        const resultExpiryEl = document.getElementById('result-expiry');
        const resultViewsEl = document.getElementById('result-views');
        const resultCreatedEl = document.getElementById('result-created');
        const copyLinkBtn = document.getElementById('copy-link');
        const openLinkBtn = document.getElementById('open-link');
        const newLinkBtn = document.getElementById('new-link');
        const historyList = document.getElementById('history-list');
        const historyCount = document.getElementById('history-count');
        const clearHistoryBtn = document.getElementById('clear-history');
        const imageDropzone = document.getElementById('image-dropzone');
        const imageUpload = document.getElementById('image-upload');
        const imagePreview = document.getElementById('image-preview');
        const previewImg = document.getElementById('preview-img');
        const removeImageBtn = document.getElementById('remove-image');
        
        // 输入字段
        const expiryTimeInput = document.getElementById('expiry-time');
        const maxViewsInput = document.getElementById('max-views');
        const contentTextInput = document.getElementById('content-text');
        const contentUrlInput = document.getElementById('content-url');
        
        // 密码验证
        loginBtn.addEventListener('click', () => {
            if (passwordInput.value === '007') {
                passwordScreen.classList.add('hidden');
                toolScreen.classList.remove('hidden');
                updateHistoryList();
                
                // 添加进入动画
                toolScreen.classList.add('animate-fade-in');
                setTimeout(() => {
                    toolScreen.classList.remove('animate-fade-in');
                }, 500);
            } else {
                errorMessage.classList.remove('hidden');
                passwordInput.classList.add('border-red-500');
                
                // 抖动动画
                passwordInput.classList.add('animate-shake');
                setTimeout(() => {
                    passwordInput.classList.remove('animate-shake');
                }, 500);
            }
        });
        
        // 切换密码可见性
        togglePassword.addEventListener('click', () => {
            const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', type);
            togglePassword.innerHTML = type === 'password' ? '<i class="fa fa-eye-slash"></i>' : '<i class="fa fa-eye"></i>';
        });
        
        // 内容类型切换
        contentTypes.forEach(btn => {
            btn.addEventListener('click', () => {
                // 移除所有活动状态
                contentTypes.forEach(b => {
                    b.classList.remove('active', 'bg-primary/10', 'text-primary', 'border-primary');
                    b.classList.add('border-primary/30', 'hover:border-primary', 'hover:bg-primary/5', 'text-light/70', 'hover:text-primary');
                });
                
                // 设置当前按钮为活动状态
                btn.classList.add('active', 'bg-primary/10', 'text-primary', 'border-primary');
                btn.classList.remove('border-primary/30', 'hover:border-primary', 'hover:bg-primary/5', 'text-light/70', 'hover:text-primary');
                
                // 显示对应的内容输入区域
                const type = btn.getAttribute('data-type');
                contentInputs.forEach(input => {
                    input.classList.add('hidden');
                });
                document.getElementById(`${type}-content`).classList.remove('hidden');
            });
        });
        
        // 图片上传处理
        imageDropzone.addEventListener('click', () => {
            imageUpload.click();
        });
        
        imageUpload.addEventListener('change', (e) => {
            if (e.target.files && e.target.files[0]) {
                previewImage(e.target.files[0]);
            }
        });
        
        // 拖放功能
        imageDropzone.addEventListener('dragover', (e) => {
            e.preventDefault();
            imageDropzone.classList.add('border-primary', 'bg-primary/5');
        });
        
        imageDropzone.addEventListener('dragleave', () => {
            imageDropzone.classList.remove('border-primary', 'bg-primary/5');
        });
        
        imageDropzone.addEventListener('drop', (e) => {
            e.preventDefault();
            imageDropzone.classList.remove('border-primary', 'bg-primary/5');
            
            if (e.dataTransfer.files && e.dataTransfer.files[0]) {
                previewImage(e.dataTransfer.files[0]);
            }
        });
        
        // 预览图片
        function previewImage(file) {
            if (!file.type.match('image.*')) {
                alert('请上传图片文件');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                previewImg.src = e.target.result;
                imagePreview.classList.remove('hidden');
            };
            reader.readAsDataURL(file);
        }
        
        // 移除图片
        removeImageBtn.addEventListener('click', () => {
            imagePreview.classList.add('hidden');
            previewImg.src = '';
            imageUpload.value = '';
        });
        
        // 生成链接
        generateBtn.addEventListener('click', () => {
            // 获取当前选中的内容类型
            const contentType = document.querySelector('.content-type-btn.active').getAttribute('data-type');
            
            // 获取内容
            let content = null;
            if (contentType === 'text') {
                content = contentTextInput.value.trim();
                if (!content) {
                    showNotification('请输入文字内容', 'error');
                    return;
                }
                
                // 添加客服信息（隐晦地）
                content += "\n\n如有问题，可联系：wxid_88672354（数字部分可尝试不同组合）";
            } else if (contentType === 'url') {
                content = contentUrlInput.value.trim();
                if (!content) {
                    showNotification('请输入网址', 'error');
                    return;
                }
                // 简单验证URL格式
                try {
                    new URL(content);
                } catch (e) {
                    showNotification('请输入有效的网址', 'error');
                    return;
                }
            } else if (contentType === 'image') {
                if (!previewImg.src) {
                    showNotification('请上传图片', 'error');
                    return;
                }
                content = previewImg.src;
            }
            
            // 获取有效期和最大访问次数
            const expiryTime = parseInt(expiryTimeInput.value);
            const maxViews = parseInt(maxViewsInput.value);
            
            if (isNaN(expiryTime) || expiryTime < 1) {
                showNotification('请输入有效的有效期', 'error');
                return;
            }
            
            if (isNaN(maxViews) || maxViews < 1) {
                showNotification('请输入有效的最大访问次数', 'error');
                return;
            }
            
            // 生成随机链接ID
            const linkId = generateRandomId();
            
            // 计算过期时间
            const now = new Date();
            const expiryDate = new Date(now.getTime() + expiryTime * 60000);
            
            // 保存链接数据
            linksData[linkId] = {
                id: linkId,
                content: content,
                type: contentType,
                expiry: expiryDate.toISOString(),
                maxViews: maxViews,
                views: 0,
                created: now.toISOString()
            };
            
            // 保存到本地存储
            saveLinksData();
            
            // 显示结果
            displayResult(linkId);
            
            // 更新历史记录
            updateHistoryList();
            
            // 清空输入
            clearInputs();
            
            showNotification('链接生成成功', 'success');
        });
        
        // 生成随机ID
        function generateRandomId() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let id = '';
            for (let i = 0; i < 10; i++) {
                id += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            // 确保ID唯一
            if (linksData[id]) {
                return generateRandomId();
            }
            return id;
        }
        
        // 显示生成结果
        function displayResult(linkId) {
            currentLinkId = linkId;
            const linkData = linksData[linkId];
            const link = `${window.location.origin}${window.location.pathname}?id=${linkId}`;
            
            generatedLinkEl.textContent = link;
            resultExpiryEl.textContent = `${expiryTimeInput.value} 分钟`;
            resultViewsEl.textContent = `${linkData.maxViews} 次`;
            
            // 格式化创建时间
            const createdDate = new Date(linkData.created);
            resultCreatedEl.textContent = createdDate.toLocaleString();
            
            resultContainer.classList.remove('hidden');
            
            // 添加显示动画
            resultContainer.classList.add('animate-fade-in');
            setTimeout(() => {
                resultContainer.classList.remove('animate-fade-in');
            }, 500);
        }
        
        // 复制链接
        copyLinkBtn.addEventListener('click', () => {
            if (!currentLinkId) return;
            
            const link = `${window.location.origin}${window.location.pathname}?id=${currentLinkId}`;
            navigator.clipboard.writeText(link).then(() => {
                const originalText = copyLinkBtn.innerHTML;
                copyLinkBtn.innerHTML = '<i class="fa fa-check"></i><span>已复制</span>';
                copyLinkBtn.classList.add('bg-green-500/20', 'border-green-500/50', 'text-green-400');
                copyLinkBtn.classList.remove('bg-primary/20', 'border-primary/50', 'text-primary');
                
                setTimeout(() => {
                    copyLinkBtn.innerHTML = originalText;
                    copyLinkBtn.classList.remove('bg-green-500/20', 'border-green-500/50', 'text-green-400');
                    copyLinkBtn.classList.add('bg-primary/20', 'border-primary/50', 'text-primary');
                }, 2000);
            });
        });
        
        // 打开链接
        openLinkBtn.addEventListener('click', () => {
            if (!currentLinkId) return;
            const link = `${window.location.origin}${window.location.pathname}?id=${currentLinkId}`;
            window.open(link, '_blank');
        });
        
        // 新建链接
        newLinkBtn.addEventListener('click', () => {
            resultContainer.classList.add('hidden');
            currentLinkId = null;
            clearInputs();
        });
        
        // 清空输入
        function clearInputs() {
            contentTextInput.value = '';
            contentUrlInput.value = '';
            if (previewImg.src) {
                imagePreview.classList.add('hidden');
                previewImg.src = '';
                imageUpload.value = '';
            }
            expiryTimeInput.value = '5';
            maxViewsInput.value = '3';
        }
        
        // 更新历史记录列表
        function updateHistoryList() {
            const linkIds = Object.keys(linksData).sort((a, b) => {
                return new Date(linksData[b].created) - new Date(linksData[a].created);
            });
            
            historyCount.textContent = linkIds.length;
            
            if (linkIds.length === 0) {
                historyList.innerHTML = `
                    <div class="text-center text-light/50 py-8">
                        <i class="fa fa-history text-4xl mb-3"></i>
                        <p>暂无历史记录</p>
                    </div>
                `;
                return;
            }
            
            historyList.innerHTML = '';
            
            linkIds.forEach(linkId => {
                const linkData = linksData[linkId];
                const isExpired = isLinkExpired(linkId);
                const isUsedUp = linkData.views >= linkData.maxViews;
                const status = isExpired ? '已过期' : isUsedUp ? '已用完' : '有效';
                const statusClass = isExpired || isUsedUp ? 'text-red-400' : 'text-green-400';
                
                const createdDate = new Date(linkData.created);
                
                const historyItem = document.createElement('div');
                historyItem.className = `p-4 bg-dark/30 rounded-lg border border-primary/20 hover:border-primary/50 transition-all ${isExpired || isUsedUp ? 'opacity-70' : ''}`;
                historyItem.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <div class="font-medium text-primary truncate max-w-[70%]">
                            ${linkData.type === 'text' ? '<i class="fa fa-file-text-o mr-1"></i> 文字内容' : 
                              linkData.type === 'url' ? '<i class="fa fa-link mr-1"></i> 网址' : 
                              '<i class="fa fa-image mr-1"></i> 图片'}
                        </div>
                        <span class="text-sm ${statusClass}">${status}</span>
                    </div>
                    <div class="text-sm text-light/60 mb-3 truncate">
                        ${linkData.type === 'url' ? linkData.content : 
                          linkData.type === 'text' ? (linkData.content.length > 30 ? linkData.content.substring(0, 30) + '...' : linkData.content) : 
                          '图片内容'}
                    </div>
                    <div class="flex justify-between items-center text-xs text-light/50">
                        <span>创建于 ${createdDate.toLocaleString()}</span>
                        <div class="flex gap-2">
                            <button class="view-history-link hover:text-primary transition-colors" data-id="${linkId}">
                                <i class="fa fa-external-link"></i>
                            </button>
                            <button class="copy-history-link hover:text-primary transition-colors" data-id="${linkId}">
                                <i class="fa fa-copy"></i>
                            </button>
                            <button class="delete-history-link hover:text-red-400 transition-colors" data-id="${linkId}">
                                <i class="fa fa-trash-o"></i>
                            </button>
                        </div>
                    </div>
                `;
                
                historyList.appendChild(historyItem);
            });
            
            // 添加历史记录项事件监听
            document.querySelectorAll('.view-history-link').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const linkId = e.currentTarget.getAttribute('data-id');
                    const link = `${window.location.origin}${window.location.pathname}?id=${linkId}`;
                    window.open(link, '_blank');
                });
            });
            
            document.querySelectorAll('.copy-history-link').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const linkId = e.currentTarget.getAttribute('data-id');
                    const link = `${window.location.origin}${window.location.pathname}?id=${linkId}`;
                    navigator.clipboard.writeText(link).then(() => {
                        showNotification('链接已复制', 'success');
                    });
                });
            });
            
            document.querySelectorAll('.delete-history-link').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const linkId = e.currentTarget.getAttribute('data-id');
                    if (confirm('确定要删除这条记录吗？')) {
                        delete linksData[linkId];
                        saveLinksData();
                        updateHistoryList();
                        showNotification('记录已删除', 'info');
                    }
                });
            });
        }
        
        // 清空历史记录
        clearHistoryBtn.addEventListener('click', () => {
            if (Object.keys(linksData).length === 0) {
                showNotification('没有记录可清空', 'info');
                return;
            }
            
            if (confirm('确定要清空所有历史记录吗？此操作不可恢复。')) {
                linksData = {};
                saveLinksData();
                updateHistoryList();
                showNotification('所有记录已清空', 'info');
            }
        });
        
        // 保存链接数据到本地存储
        function saveLinksData() {
            localStorage.setItem('tempLinks', JSON.stringify(linksData));
        }
        
        // 检查链接是否过期
        function isLinkExpired(linkId) {
            const linkData = linksData[linkId];
            if (!linkData) return true;
            
            const now = new Date();
            const expiryDate = new Date(linkData.expiry);
            
            return now > expiryDate;
        }
        
        // 显示通知
        function showNotification(message, type = 'info') {
            // 创建通知元素
            const notification = document.createElement('div');
            notification.className = `fixed bottom-4 right-4 px-4 py-3 rounded-lg shadow-lg z-50 transform translate-y-10 opacity-0 transition-all duration-300 flex items-center gap-2`;
            
            // 设置样式根据类型
            let bgColor, textColor, icon;
            switch (type) {
                case 'success':
                    bgColor = 'bg-green-900/70 border border-green-500/50';
                    textColor = 'text-green-300';
                    icon = 'fa-check-circle';
                    break;
                case 'error':
                    bgColor = 'bg-red-900/70 border border-red-500/50';
                    textColor = 'text-red-300';
                    icon = 'fa-exclamation-circle';
                    break;
                case 'info':
                default:
                    bgColor = 'bg-blue-900/70 border border-blue-500/50';
                    textColor = 'text-blue-300';
                    icon = 'fa-info-circle';
                    break;
            }
            
            notification.classList.add(...bgColor.split(' '), ...textColor.split(' '));
            notification.innerHTML = `<i class="fa ${icon}"></i><span>${message}</span>`;
            
            // 添加到页面
            document.body.appendChild(notification);
            
            // 显示动画
            setTimeout(() => {
                notification.classList.remove('translate-y-10', 'opacity-0');
            }, 10);
            
            // 3秒后隐藏
            setTimeout(() => {
                notification.classList.add('translate-y-10', 'opacity-0');
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }
        
        // 处理链接查看
        function handleLinkView() {
            const urlParams = new URLSearchParams(window.location.search);
            const linkId = urlParams.get('id');
            
            if (!linkId) return;
            
            const linkData = linksData[linkId];
            
            // 如果链接不存在，显示过期页面
            if (!linkData) {
                showExpiredContent();
                return;
            }
            
            // 检查链接是否过期或已达到最大访问次数
            const isExpired = isLinkExpired(linkId);
            const isUsedUp = linkData.views >= linkData.maxViews;
            
            if (isExpired || isUsedUp) {
                showExpiredContent();
                return;
            }
            
            // 增加访问次数
            linkData.views += 1;
            saveLinksData();
            
            // 显示内容
            showValidContent(linkData);
        }
        
        // 显示有效的内容
        function showValidContent(linkData) {
            passwordScreen.classList.add('hidden');
            toolScreen.classList.add('hidden');
            viewScreen.classList.remove('hidden');
            validContent.classList.remove('hidden');
            expiredContent.classList.add('hidden');
            
            // 根据内容类型显示不同的内容
            let contentHtml = '';
            switch (linkData.type) {
                case 'text':
                    // 将文本转换为HTML，保留换行
                    const formattedText = linkData.content.replace(/\n/g, '<br>');
                    contentHtml = `
                        <div class="prose prose-invert max-w-none">
                            <p>${formattedText}</p>
                        </div>
                    `;
                    break;
                case 'url':
                    contentHtml = `
                        <div class="text-center">
                            <i class="fa fa-link text-4xl text-primary mb-4"></i>
                            <p class="mb-6">即将跳转到以下网址：</p>
                            <p class="break-all mb-6 p-3 bg-dark/30 rounded-lg border border-primary/20">${linkData.content}</p>
                            <a href="${linkData.content}" target="_blank" class="inline-flex items-center gap-2 px-6 py-3 bg-primary/20 hover:bg-primary/30 text-primary border border-primary/50 rounded-lg transition-all duration-300">
                                <span>立即访问</span>
                                <i class="fa fa-external-link"></i>
                            </a>
                        </div>
                    `;
                    break;
                case 'image':
                    contentHtml = `
                        <div class="text-center">
                            <img src="${linkData.content}" alt="图片内容" class="max-w-full max-h-[70vh] mx-auto rounded-lg shadow-lg mb-4">
                            <p class="text-light/60 text-sm">
                                剩余查看次数: ${linkData.maxViews - linkData.views} / ${linkData.maxViews}
                            </p>
                        </div>
                    `;
                    break;
            }
            
            validContent.innerHTML = contentHtml;
        }
        
        // 显示过期内容
        function showExpiredContent() {
            passwordScreen.classList.add('hidden');
            toolScreen.classList.add('hidden');
            viewScreen.classList.remove('hidden');
            validContent.classList.add('hidden');
            expiredContent.classList.remove('hidden');
        }
        
        // 添加动画样式
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
            .animate-fade-in {
                animation: fadeIn 0.5s ease-out forwards;
            }
            .animate-shake {
                animation: shake 0.5s ease-in-out;
            }
        `;
        document.head.appendChild(style);
        
        // 页面加载时检查是否是查看链接
        window.addEventListener('DOMContentLoaded', () => {
            handleLinkView();
        });
    </script>


</body></html>
